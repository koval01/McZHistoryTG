$(document).ready(function () {
    function clear_str_(string_) {
        return string_.toString().replace(/\\n/g, '').replace(/\\"/g, '"').replace(/\\/g, '')
    }
    function get_channel_html_data(callback, bef_ = null) {
        $.ajax({
            url: `https://zlpnews.herokuapp.com/?before=${bef_}`,
            type: "GET",
            success: function (o) {
                if (o["success"]) {
                    callback(clear_str_(o["body"]))
                } else {
                    console.log("Check error! (get_channel_html_data)")
                }
            },
            error: function () {
                console.log("Error get channel data!")
            }
        })
    }
    function struct_els(els) {
        for (let i = 0; i < els.length; i++) {
            console.log(typeof els[i])
        }
    }
    function loads_posts(before = null) {
        get_channel_html_data(function (data) { 
            const el = $('<div></div>')
            el.html(data)
            const parsed_els = $('.tgme_widget_message_wrap', el)
            const struct = struct_els(parsed_els)
        }, bef_ = before)
    }

    // init
    loads_posts()
})
