$(document).ready(function () {
    function clear_str_(string_) {
        return string_.toString().replace(/\\/g, '').replace(/\n/g, '').replace(/\\"/g, '"')
    }
    function get_channel_html_data(callback, bef_ = null) {
        $.ajax({
            url: `https://zlpnews.herokuapp.com/?before=${bef_}`,
            type: "GET",
            success: function (o) {
                if (o["success"]) {
                    callback(clear_str_(o["body"]))
                } else {
                    console.log("Check error! (get_channel_html_data)")
                }
            },
            error: function () {
                console.log("Error get channel data!")
            }
        })
    }
    function get_all_posts() {
        get_channel_html_data(function (data) { 
            const el = $('<div></div>')
            el.html(data)
            return $('.tgme_widget_message_wrap', el)
        })
    }

    // test
    get_channel_html_data(function (data) {console.log(data)})
    console.log(get_all_posts())
})
