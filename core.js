function mediaError(e){return e.onerror="",e.src="",!0}$(document).ready(function(){function e(e){const t=Date.parse(e),o=(new Date).getTimezoneOffset(),n=60*Math.abs(o)*1e3+t;return new Date(n).toLocaleString()}function t(e){var t=[];function o(e,o){t.push({m_type:o,m_url:e})}function n(e,t){for(let n=0;n<e.length;n++){let a=null;const r=$("<div></div>");r.html(e[n]),"image"==t?a=$(".tgme_widget_message_photo_wrap",r).css("background-image").replace(/url\(\"/g,"").replace(/\"\)/g,""):"video"==t&&(a=$(".tgme_widget_message_video",r).attr("src")),o(a,t)}}try{n($(".tgme_widget_message_photo_wrap",e),"image")}catch(e){console.log(`Images extract catch: ${e}`)}try{n($(".tgme_widget_message_video",e),"video")}catch(e){console.log(`Videos extract catch: ${e}`)}return console.log(t),t}function o(e){const t=e.media.data,o=e.meta.views,n=e.meta.time,a=e.data_post;let r=e.post_text;r||(r="");const s=`\n            <div class="col" style="margin-bottom:0.7em">\n                <div class="card shadow-sm">\n                    ${function(e){let t="";for(let o=0;o<e.length;o++)e[o].m_url&&("image"==e[o].m_type?t=`${t}\n${`\n                    <img src="${e[o].m_url}" onerror="mediaError(this);" class="bd-placeholder-img card-img-top" \n                        width="100%" height="100%" role="img" title="Фото" aria-label="Фото" \n                        style="margin-bottom:0.4em;border-radius:0.2em!important">`}`:"video"==e[o].m_type&&(t=`${t}\n${`\n                    <video src="${e[o].m_url}" onerror="mediaError(this);" class="bd-placeholder-img card-img-top" \n                        width="100%" height="100%" role="img" title="Видео" aria-label="Видео" \n                        style="margin-bottom:0.4em;border-radius:0.2em!important"></video>`}`));return t}(t)}\n                    <div class="card-body">\n                        <p class="card-text" style="margin-top:-0.8em">${r}</p>\n                        <div class="d-flex justify-content-between align-items-center">\n                            <small class="text-muted">\n                                <span class="post_views">${o}</span> | \n                                ${n} | \n                                <a href="https://t.me/${a}" target="_blank">В TG</a>\n                                <br/>by Elon Tusk\n                            </small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;console.log(`Result pattern: ${s}`),$(".row-global-block").append(s)}!function(n=null){!function(e,t=null){$.ajax({url:`https://zlpnews.herokuapp.com/?before=${t}`,type:"GET",success:function(t){t.success?e(t.body.toString().replace(/\\n/g,"").replace(/\\"/g,'"').replace(/\\/g,"")):console.log("Check error! (get_channel_html_data)")},error:function(){console.log("Error get channel data!")}})}(function(n){const a=$("<div></div>");a.html(n);const r=function(o){console.log(`Len els: ${o.length}`);let n=[];for(let a=0;a<o.length;a++){console.log(o[a]);const r=$("<div></div>");r.html(o[a]);const s=$(".tgme_widget_message_text",r).html(),l=$(".tgme_widget_message_views",r).html(),i=$(".tgme_widget_message",r).attr("data-post"),c=e($(".time",r).attr("datetime")),m=t(r);n.push({post_text:s,meta:{views:l,time:c},media:{data:m},data_post:i})}return n.reverse()}($(".tgme_widget_message_wrap",a));for(let e=0;e<r.length;e++)console.log(r[e]),o(r[e])},bef_=n)}()});
